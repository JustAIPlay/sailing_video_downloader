<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>大航海视频下载神器</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 背景装饰 -->
    <div class="bg-decoration">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- 主容器 -->
    <div class="container">

        <!-- ==================== 主下载页面 ==================== -->
        <div class="page" id="mainPage">
            <!-- 头部插画区域 -->
            <div class="header-section">
                <div class="illustration">
                    <svg viewBox="0 0 800 400" class="main-illustration">
                        <!-- 定义渐变和动画 -->
                        <defs>
                            <!-- 天空渐变 -->
                            <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#E8D5FF;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#FFE5C4;stop-opacity:1" />
                            </linearGradient>

                            <!-- 海水渐变 -->
                            <linearGradient id="seaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#C4A8FF;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#A855F7;stop-opacity:1" />
                            </linearGradient>

                            <!-- 太阳渐变 -->
                            <radialGradient id="sunGradient" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" style="stop-color:#FFD700;stop-opacity:0.9" />
                                <stop offset="100%" style="stop-color:#FFB347;stop-opacity:0.6" />
                            </radialGradient>

                            <!-- 船只摇摆动画 -->
                            <style>
                                @keyframes rock {
                                    0%, 100% { transform: rotate(-1.5deg); }
                                    50% { transform: rotate(1.5deg); }
                                }
                                @keyframes waveMove {
                                    0% { transform: translateX(0); }
                                    100% { transform: translateX(-40px); }
                                }
                                @keyframes float {
                                    0%, 100% { transform: translateY(0); }
                                    50% { transform: translateY(-3px); }
                                }
                                @keyframes sunGlow {
                                    0%, 100% { opacity: 0.8; }
                                    50% { opacity: 1; }
                                }
                                .boat-group {
                                    animation: rock 4s ease-in-out infinite;
                                    transform-origin: 400px 300px;
                                }
                                .wave-path {
                                    animation: waveMove 3s linear infinite;
                                }
                                .sun-glow {
                                    animation: sunGlow 3s ease-in-out infinite;
                                }
                                .bird {
                                    animation: float 2s ease-in-out infinite;
                                }
                            </style>
                        </defs>

                        <!-- 背景：天空 -->
                        <rect width="800" height="400" fill="url(#skyGradient)" opacity="0.4" rx="16"/>

                        <!-- 太阳 -->
                        <circle class="sun-glow" cx="650" cy="80" r="45" fill="url(#sunGradient)" />
                        <circle cx="650" cy="80" r="35" fill="#FFD700" opacity="0.5"/>

                        <!-- 云朵 -->
                        <g opacity="0.7">
                            <ellipse cx="120" cy="70" rx="40" ry="20" fill="#FFFFFF"/>
                            <ellipse cx="150" cy="65" rx="30" ry="18" fill="#FFFFFF"/>
                            <ellipse cx="90" cy="65" rx="25" ry="15" fill="#FFFFFF"/>
                        </g>
                        <g opacity="0.5">
                            <ellipse cx="550" cy="50" rx="35" ry="16" fill="#FFFFFF"/>
                            <ellipse cx="575" cy="45" rx="25" ry="14" fill="#FFFFFF"/>
                        </g>

                        <!-- 远处的海鸥 -->
                        <g class="bird" stroke="#9333EA" stroke-width="2" fill="none" opacity="0.6">
                            <path d="M200 120 Q210 110 220 120 Q230 110 240 120" />
                            <path d="M260 100 Q265 95 270 100 Q275 95 280 100" />
                        </g>

                        <!-- 海水层 1 (远处) -->
                        <path d="M0 280 Q200 260 400 280 T800 280 L800 400 L0 400 Z" fill="#C4A8FF" opacity="0.3" />

                        <!-- 海水层 2 (波浪动画) -->
                        <path class="wave-path" d="M-40 310 Q160 290 360 310 T760 310 T1160 310 L1160 400 L-40 400 Z" fill="url(#seaGradient)" opacity="0.4" />

                        <!-- 海水层 3 (前景) -->
                        <path class="wave-path" d="M0 340 Q200 320 400 340 T800 340 T1200 340 L1200 400 L0 400 Z" fill="url(#seaGradient)" opacity="0.5" style="animation-delay: -1s;" />

                        <!-- 帆船组 -->
                        <g class="boat-group">
                            <!-- 船体 -->
                            <path d="M320 310 L480 310 L460 350 L340 350 Z" fill="#8B5CF6" />
                            <path d="M340 350 L460 350 Q400 360 340 350" fill="#A78BDF"/>

                            <!-- 桅杆 -->
                            <rect x="395" y="180" width="10" height="130" rx="2" fill="#7C3AED" />

                            <!-- 后帆 (大) -->
                            <path d="M407 190 L407 300 L530 300 Z" fill="#FFFFFF" opacity="0.95" />
                            <path d="M407 190 L407 300 L530 300" stroke="#E8D5FF" stroke-width="1" fill="none"/>

                            <!-- 前帆 (小) -->
                            <path d="M393 200 L393 300 L280 300 Z" fill="#F3E8FF" opacity="0.9" />
                            <path d="M393 200 L393 300 L280 300" stroke="#E8D5FF" stroke-width="1" fill="none"/>

                            <!-- 旗帜 -->
                            <polygon points="407,175 430,185 407,195" fill="#FFB347" />
                            <line x1="407" y1="175" x2="407" y2="195" stroke="#9333EA" stroke-width="1"/>

                            <!-- 船体细节 -->
                            <rect x="360" y="315" width="80" height="8" rx="2" fill="#7C3AED" opacity="0.5"/>
                        </g>

                        <!-- 小波浪装饰 -->
                        <g stroke="#D8B4FE" stroke-width="2" fill="none" opacity="0.6">
                            <path d="M150 380 Q165 375 180 380 Q195 385 210 380" />
                            <path d="M580 370 Q595 365 610 370 Q625 375 640 370" />
                            <path d="M680 390 Q690 387 700 390 Q710 393 720 390" />
                        </g>
                    </svg>
                </div>
                <h1 class="title">大航海视频下载神器</h1>
                <p class="subtitle">批量下载飞书视频附件</p>
            </div>

            <!-- 配置预览卡片 -->
            <div class="card config-preview-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="8" stroke="#B794F6" stroke-width="1.5"/>
                        <circle cx="10" cy="7" r="2" fill="#B794F6"/>
                        <path d="M7 14C7 12 8.5 11 10 11C11.5 11 13 12 13 14" stroke="#B794F6" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>当前配置</span>
                    <button class="icon-btn" id="toSettingsBtn" title="系统设置">
                        ⚙️
                    </button>
                </div>
                <div class="card-content config-preview">
                    <div class="preview-item">
                        <span class="preview-label">App ID</span>
                        <span class="preview-value" id="previewAppId">未配置</span>
                    </div>
                    <div class="preview-item">
                        <span class="preview-label">Base Token</span>
                        <span class="preview-value" id="previewBaseToken">未配置</span>
                    </div>
                    <div class="preview-item">
                        <span class="preview-label">Table ID</span>
                        <span class="preview-value" id="previewTableId">未配置</span>
                    </div>
                    <div class="preview-item">
                        <span class="preview-label">保存路径</span>
                        <span class="preview-value" id="previewSaveDir">FeishuVideos</span>
                    </div>
                </div>
            </div>

            <!-- 操作区域 -->
            <div class="action-row">
                <button id="startBtn" class="btn btn-primary">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                        <path d="M3 9L15 9M15 9L9 3M15 9L9 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    开始下载
                </button>
                <button id="stopBtn" class="btn btn-danger" style="display: none;">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                        <rect x="4" y="4" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    停止下载
                </button>
                <button id="resetBtn" class="btn btn-warning" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M8 2L8 6M8 6L5.5 4M8 6L10.5 4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="8" cy="11" r="3" stroke="currentColor" stroke-width="1.2"/>
                    </svg>
                    重置状态
                </button>
                <button id="clearHistoryBtn" class="btn btn-ghost">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M3 5H13M5 5V3H11V5M5 5V13M11 5V13M7 7V11M9 7V11" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                    清除缓存
                </button>
            </div>

            <!-- 状态卡片 -->
            <div class="card status-card">
                <div class="status-header">
                    <div class="status-indicator">
                        <span class="status-dot"></span>
                        <span id="statusText">准备就绪</span>
                    </div>
                    <div class="status-count" id="progressText">0 / 0</div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar"></div>
                    </div>
                </div>

                <div class="log-area" id="logArea"></div>
            </div>

            <!-- 底部装饰插画 -->
            <div class="footer-decoration">
                <svg viewBox="0 0 300 60" class="footer-illustration">
                    <path d="M0 60 L0 40 Q50 20 100 35 Q150 50 200 30 Q250 15 300 35 L300 60 Z" fill="#E8D5FF" opacity="0.3"/>
                    <path d="M0 60 L50 60 Q100 35 150 45 Q200 55 250 40 Q275 32 300 40 L300 60 Z" fill="#C4A8FF" opacity="0.2"/>
                    <ellipse cx="50" cy="25" rx="15" ry="8" fill="#FFE5C4" opacity="0.4"/>
                    <ellipse cx="60" cy="22" rx="10" ry="6" fill="#FFE5C4" opacity="0.4"/>
                    <ellipse cx="250" cy="20" rx="12" ry="6" fill="#E8D5FF" opacity="0.3"/>
                </svg>
            </div>
        </div>

        <!-- ==================== 系统设置页面 ==================== -->
        <div class="page" id="settingsPage" style="display: none;">
            <!-- 设置页头部 -->
            <div class="settings-header">
                <button class="back-btn" id="backToMainBtn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M12 16L8 12L12 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    返回
                </button>
                <h2 class="settings-title">系统设置</h2>
            </div>

            <!-- 设置页插画 -->
            <div class="settings-illustration">
                <svg viewBox="0 0 200 100" class="settings-art">
                    <defs>
                        <linearGradient id="gearGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#C4A8FF"/>
                            <stop offset="100%" style="stop-color:#B794F6"/>
                        </linearGradient>
                    </defs>
                    <!-- 装饰圆 -->
                    <circle cx="100" cy="50" r="40" fill="url(#purpleGrad)" opacity="0.2"/>
                    <circle cx="40" cy="30" r="15" fill="#FFE5C4" opacity="0.4"/>
                    <circle cx="160" cy="60" r="12" fill="#FFE5A8" opacity="0.5"/>

                    <!-- 齿轮图标 -->
                    <g transform="translate(80, 20)">
                        <circle cx="20" cy="20" r="18" fill="url(#gearGrad)"/>
                        <circle cx="20" cy="20" r="8" fill="#E8D5FF"/>
                        <circle cx="20" cy="20" r="4" fill="#A78BDF"/>
                        <!-- 齿轮齿 -->
                        <rect x="17" y="0" width="6" height="8" rx="2" fill="#B794F6"/>
                        <rect x="17" y="32" width="6" height="8" rx="2" fill="#B794F6"/>
                        <rect x="0" y="17" width="8" height="6" rx="2" fill="#B794F6"/>
                        <rect x="32" y="17" width="8" height="6" rx="2" fill="#B794F6"/>
                        <rect x="4" y="4" width="7" height="6" rx="2" fill="#B794F6" transform="rotate(45 7.5 7)"/>
                        <rect x="29" y="4" width="7" height="6" rx="2" fill="#B794F6" transform="rotate(-45 32.5 7)"/>
                        <rect x="4" y="30" width="7" height="6" rx="2" fill="#B794F6" transform="rotate(-45 7.5 33)"/>
                        <rect x="29" y="30" width="7" height="6" rx="2" fill="#B794F6" transform="rotate(45 32.5 33)"/>
                    </g>

                    <!-- 星星装饰 -->
                    <circle cx="30" cy="70" r="2" fill="#C4A8FF"/>
                    <circle cx="170" cy="25" r="2.5" fill="#FFB347"/>
                    <circle cx="140" cy="85" r="1.5" fill="#E8D5FF"/>
                </svg>
            </div>

            <!-- 配置卡片 -->
            <div class="card config-card">
                <div class="card-header">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="8" stroke="#B794F6" stroke-width="1.5"/>
                        <circle cx="10" cy="7" r="2" fill="#B794F6"/>
                        <path d="M7 14C7 12 8.5 11 10 11C11.5 11 13 12 13 14" stroke="#B794F6" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>API 配置</span>
                </div>

                <div class="card-content">
                    <div class="form-group">
                        <label>App ID</label>
                        <input type="text" id="appId" placeholder="cli_..." class="input-field">
                    </div>

                    <div class="form-group">
                        <label>App Secret</label>
                        <input type="password" id="appSecret" class="input-field">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Base Token</label>
                            <input type="text" id="baseToken" placeholder="N6...d5" class="input-field">
                        </div>
                        <div class="form-group">
                            <label>Table ID</label>
                            <input type="text" id="tableId" placeholder="tbl..." class="input-field">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>视频链接字段</label>
                            <input type="text" id="fieldVideo" value="视频链接" class="input-field">
                        </div>
                        <div class="form-group">
                            <label>脚本号字段</label>
                            <input type="text" id="fieldScript" value="脚本号" class="input-field">
                            <small style="color: #9CA3AF; font-size: 12px; margin-top: 4px; display: block;">同时用于筛选和文件命名</small>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>起始脚本号</label>
                            <input type="text" id="startScriptNo" placeholder="例如: JQym000053" class="input-field">
                            <small style="color: #9CA3AF; font-size: 12px; margin-top: 4px; display: block;">留空则从第一条开始下载</small>
                        </div>
                        <div class="form-group">
                            <label>脚本号字段</label>
                            <input type="text" id="fieldScript" value="脚本号" class="input-field">
                            <small style="color: #9CA3AF; font-size: 12px; margin-top: 4px; display: block;">用于筛选范围和文件命名</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>保存路径</label>
                        <input type="text" id="saveDir" value="FeishuVideos" class="input-field">
                    </div>

                    <button id="saveConfigBtn" class="btn btn-primary">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 2L8 10M8 10L5.5 7.5M8 10L10.5 7.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M3 13H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        保存配置
                    </button>
                </div>
            </div>

            <!-- 设置说明 -->
            <div class="settings-tips">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <circle cx="8" cy="8" r="6" stroke="#B794F6" stroke-width="1.2"/>
                    <path d="M8 5V9M8 11V11.5" stroke="#B794F6" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
                <span>配置保存后会自动返回主页面</span>
            </div>
        </div>

    </div>

    <script src="popup.js"></script>
</body>
</html>
